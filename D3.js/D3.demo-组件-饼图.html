<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>饼图</title>
  <style>
    path {
      transition: all .2s;
    }
  </style>
</head>
<body>
<div id="cake"></div>
<script src="./dist/d3.js"></script>
<script>
let width = 600
let height = 800
let data = [10, 40, 27, 48, 12]
// 外半径
let outerRadius = 150
// 内半径
let innerRadius = 0

let cake = d3.select('#cake')
let svg = cake.append('svg')
svg.attr('style', `width: ${width};height: ${height};`)

// 数据转换 将数据转化为path路径可以用的数据
let pie = d3.pie()
let cake_data = pie(data)

// 设置元半径  arc 是个函数 可以
let arc = d3.arc().innerRadius(innerRadius).outerRadius(outerRadius)

// 设置颜色区间
let color = d3.interpolateRgb(d3.rgb('#59dfff'), d3.rgb('#e059ff'))
cake_data.forEach((item, index) => {
  svg
    .append('g')
    .attr("transform","translate("+ (width/2) +","+ (height/2) +")")
    .append('path')
    .attr('stroke-width', '0px')
    .attr('d', arc(item))
    .attr('fill', color(item.data / 100))
    .on('mouseover', function () {
      let new_arc = d3.arc().innerRadius(innerRadius).outerRadius(outerRadius + 15)
      d3.select(this).attr('d', new_arc(item))
    })
    .on('mouseout', function () {
      d3.select(this).attr('d', arc(item))
    })
  // d3.selectAll('svg > g:nth-child(' + (index + 1) + ')')
  //   .append('text')
  //   .text(data[index])
  //   .attr("transform",function(d){
  //     return "translate(" + arc.centroid(item).map(items => items) + ")"
  //   })
    // .instance()
  console.log(d3.selectAll('svg > g'))
})

/* ----- 生成外环 ----- */
let p_arc = d3.arc().innerRadius(innerRadius).outerRadius(innerRadius + 50)

// 获取外环path路径  
let p_data = pie(data)
console.log(p_data)
p_data.forEach((item, index) => {
  svg
    .append('g')
    .append('path')
    .attr('d', p_arc(item))
    .attr("transform","translate("+ (width/2) +","+ (height/2) +")")
})
</script>
</body>
</html>